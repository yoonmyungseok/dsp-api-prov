<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="go.kr.dsp.api.app.repository.DeployRepository">
    
    <resultMap id="DeployScript" type="go.kr.dsp.api.app.domain.DeployScript">
        <id property="id" column="id"/>
        <result property="instCd" column="inst_cd"/>
        <result property="svcCd" column="svc_cd"/>
        <result property="seq" column="seq"/>
        <result property="agentCd" column="agent_cd"/>
        <result property="execSh" column="exec_sh"/>
        <result property="resultSh" column="result_sh"/>
    </resultMap>
    
    <resultMap id="DeployFile" type="go.kr.dsp.api.app.domain.DeployFile">
        <id property="id" column="id"/>
        <result property="instCd" column="inst_cd"/>
        <result property="svcCd" column="svc_cd"/>
        <result property="seq" column="seq"/>
        <result property="agentCd" column="agent_cd"/>
        <result property="fileName" column="file_name"/>
        <result property="version" column="version"/>
        <result property="filesize" column="filesize"/>
    </resultMap>
    
    <insert id="insertScriptRecord" parameterType="go.kr.dsp.api.app.domain.DeployScript">
        INSERT INTO public.deploy_script
            (id, inst_cd, svc_cd, seq, agent_cd, updt, exec_sh, result_sh)
        VALUES (nextval('deploy_script_id_seq'::regclass),
                #{instCd},
                #{svcCd},
                #{seq},
                #{agentCd},
                now(),
                #{execSh},
                #{resultSh});
    </insert>
    
    <insert id="insertFileRecord" parameterType="go.kr.dsp.api.app.domain.DeployFile">
        INSERT INTO public.deploy_file
        (id, inst_cd, svc_cd, seq, agent_cd, file_name, updt, version, filesize)
        VALUES (nextval('deploy_file_id_seq'::regclass),
                #{instCd},
                #{svcCd},
                #{seq},
                #{agentCd},
                #{fileName},
                now(),
                #{version},
                #{filesize});
    </insert>

</mapper>